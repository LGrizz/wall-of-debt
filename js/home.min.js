$(document).ready(function(){function e(e){for(var t,a,n=e.length;n;t=parseInt(Math.random()*n),a=e[--n],e[n]=e[t],e[t]=a);return e}var t=0,a=$(".welcome").offset().top;$window=$(window);var n=[],s=0,o=[],l=!1,d=!1;$.getJSON("php/totaldebt.php",function(e){$(".total").text("$"+e),$(".total").fadeIn()}),$.getJSON("php/tweets.php",function(t){$.each(t.statuses,function(a,n){var s={};s.username=n.user.screen_name,s.tweet=n.text,o.push(s),o.length===t.statuses.length&&(e(o),c(),l=!0)})});var c=function(){$(".tweet").each(function(){$(this).find("img").fadeOut(function(){$(this).parent().prepend("<p><span class='bold'>@"+o[o.length-1].username+":</span> "+o[o.length-1].tweet+"</p>"),$(this).remove(),o.pop()})})};$.getJSON("php/wallposts.php?page="+t,function(a){$.each(a,function(s,o){var l={};l.name=o.name,l.school=o.school,l.debt=o.debt,n.push(l),n.length===a.length&&(e(n),t++,showCards())})}),showCards=function(){for(var e=Math.floor(Math.random()*(s-(s+5)+1))+(s+5),t=0;5>t;t++)0!==n.length&&(n[n.length-1].debt.length>5?($(".wall-cards").append("<div class='col-md-3 col-sm-4 item animate'><div class='card'><p class='name'>"+n[n.length-1].name+"</p><p class='debt large'>$"+n[n.length-1].debt+"</p><p class='school'>"+n[n.length-1].school+"</p></div></div>"),n.pop()):($(".wall-cards").append("<div class='col-md-3 col-sm-4 item animate'><div class='card'><p class='name'>"+n[n.length-1].name+"</p><p class='debt'>$"+n[n.length-1].debt+"</p><p class='school'>"+n[n.length-1].school+"</p></div></div>"),n.pop()),t==e-1&&t<n.length&&(l?($(".wall-cards").append("<div class='col-md-3 col-sm-4 item animate'><div class='card tweet'><p><span class='bold'>@"+o[o.length-1].username+":</span> "+o[o.length-1].tweet+"</p><div class='bird'></div></div></div>"),o.pop()):$(".wall-cards").append("<div class='col-md-3 col-sm-4 item animate'><div class='card tweet'><img src='img/loading.gif' class='img-responsive logo' alt='Tweet Loading'><div class='bird'></div></div></div>")))},$window.scroll(function(){$(window).scrollTop()>=$(document).height()-$(window).height()-250&&(0!==n.length||d?showCards():(d=!0,$.getJSON("php/wallposts.php?page="+t,function(a){$.each(a,function(s,o){var l={};l.name=o.name,l.school=o.school,l.debt=o.debt,n.push(l),n.length===a.length&&(e(n),t++,d=!1,showCards())})}))),$window.scrollTop()>=a?($(".navbar").show(),$(".to-top").fadeIn()):$window.scrollTop()<=a&&($(".navbar").hide(),$(".to-top").hide())})});